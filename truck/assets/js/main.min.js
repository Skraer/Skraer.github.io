(function() {
    var slider = new Splide( '#charsSlider', {
        type: 'loop',
        rewind: false,
        arrows: false,
        pagination: false,
        autoplay: true,
        interval: 4000,
        pauseOnHover: false,
        perMove: 1,
        autoWidth: true,
        gap: 20,
        height: 400,
        breakpoints: {
            1439: {
                height: 320
            },
            1024: {
                height: 255
            },
            767: {
                height: 200
            }
        }
    });
    slider.mount();

    var $labels = document.querySelectorAll('.calculator__cb-custom');
    for (let i = 0; i < $labels.length; i++) {
        $labels[i].onkeydown = function() {
            if (event.key === 'Enter') {
                let cb = document.querySelector('input[type="checkbox"]#' + $labels[i].getAttribute('for'));
                cb.checked = !cb.checked;
            }
        };
    }
    
    var $menuItems = document.querySelectorAll('.menu__item .menu__link');
    for (var i = 0; i < $menuItems.length; i++) {
        var elem = $menuItems[i];
        var handler = scrollHandler.bind(null, elem);
        elem.addEventListener('click', handler);
    }
    function scrollHandler(elem) {
        var href = elem.getAttribute('href').substr(1);
        event.preventDefault();
        document.getElementById(href).scrollIntoView({block: "start", behavior: "smooth"});
    }

    var $mark = document.querySelector('#svgMapMark');
    var $dots = document.querySelectorAll('.svg-map-dot');
    var $regions = document.querySelectorAll('.svg-map-region');

    var $citiesInfo = document.querySelectorAll('.dealer__info');
    var dotsData = [];
    for (var i = 0; i < $dots.length; i++) {
        var obj = {
            x: parseInt($dots[i].getAttribute('cx')),
            y: parseInt($dots[i].getAttribute('cy')),
            r: parseInt($dots[i].getAttribute('r')),
        };
        dotsData.push(obj);
        var setMarkFunc = setMark.bind(null, i);
        $dots[i].addEventListener('click', setMarkFunc);
        $regions[i].addEventListener('click', setMarkFunc);
    }
    if (window.innerWidth <=767) {
        for (var i = 0; i < $dots.length; i++) {
            var currentR = $dots[i].getAttribute('r');
            $dots[i].setAttribute('r', currentR * 2);
        }
    }

    setMark(0);
    function setMark(ind) {
        var offsetX = +$mark.getAttribute('width') / 2;
        var offsetY = +$mark.getAttribute('height');
        for (var i = 0; i < $dots.length; i++) {
            $dots[i].classList.remove('hidden');
            $citiesInfo[i].classList.add('hidden');
        }
        $dots[ind].classList.add('hidden');
        $citiesInfo[ind].classList.remove('hidden');
        $mark.setAttribute('x', dotsData[ind].x - offsetX);
        $mark.setAttribute('y', dotsData[ind].y - offsetY);   
    }

    var $burger = document.querySelector('#burger');
    var $headerMenu = document.querySelector('#headerMenu');
    var $body = document.body;
    $burger.addEventListener('click', function() {
        if ($burger.classList.contains('active')) {
            closeMenu();
        } else {
            openMenu();
        }
    });
    function closeMenu() {
        $burger.classList.remove('active');
        $headerMenu.classList.remove('active');
        $body.classList.remove('lock');
    }
    function openMenu() {
        $burger.classList.add('active');
        $headerMenu.classList.add('active');
        $body.classList.add('lock');
    }

    const $popup = document.querySelector('#popupRequest');
    const $callPopupBtns = document.querySelectorAll('.call-popup');
    for (var i = 0; i < $callPopupBtns.length; i++) {
        $callPopupBtns[i].addEventListener('click', function() {
            showPopup();
        });
        $popup.addEventListener('click', function() {
            if (event.target.id === 'popupRequest') {
                hidePopup();
            }
        });
    }

    function showPopup() {
        $popup.classList.add('active');
        $popup.classList.add('fade-in');
        $body.classList.add('lock');
    }
    function hidePopup() {
        $popup.classList.remove('fade-in');
        $popup.classList.add('fade-out');
        function removing() {
            $popup.classList.remove('active');
            $popup.classList.remove('fade-out');
            $body.classList.remove('lock');
            $popup.removeEventListener('animationend', removing);
        }
        $popup.addEventListener('animationend', removing);
    }

    // var scrollPrev = 0;
    var $header = document.querySelector('#header');
    window.addEventListener('scroll', function() {
        if (document.documentElement.scrollTop > 99) {
            $header.classList.add('fixed');
        } else {
            $header.classList.remove('fixed');
        }
    //     var scrolled = document.documentElement.scrollTop;
    //     if (scrolled > 100 && scrolled > scrollPrev) {
    //         $header.classList.add('out');
    //     } else {
    //         $header.classList.remove('out');
    //     }
    //     scrollPrev = scrolled;
    });


    var $catalogTabs = document.querySelectorAll('.catalog__tabs .catalog__tab');
    var $catalogContents = document.querySelectorAll('.catalog__contents .catalog__list');
    for (var i = 0; i < $catalogTabs.length; i++) {
        var func = activateTabContent.bind(null, i);
        $catalogTabs[i].addEventListener('click', func);
    }

    function activateTabContent(ind) {
        for (var j = 0; j < $catalogContents.length; j++) {
            $catalogTabs[j].classList.remove('active');
            $catalogContents[j].classList.add('hidden');
        }
        $catalogTabs[ind].classList.add('active');
        $catalogContents[ind].classList.remove('hidden');
        console.log($catalogContents[ind]);
    }
})();
//# sourceMappingURL=maps/main.min.js.map
