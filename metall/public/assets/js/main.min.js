const faqItems=document.querySelectorAll(".faq__item");if(faqItems&&faqItems.forEach(e=>{e.addEventListener("click",t=>{t.target.closest(".faq__title")&&e.classList.toggle("shown")})}),document.documentElement.clientWidth<=767){const e=document.querySelector(".header"),t=e.getBoundingClientRect().height,a=e.querySelector(".header__top").getBoundingClientRect().height;window.onscroll=function(s){pageYOffset>=100?(e.classList.add("fixed"),e.style.paddingBottom=t-a+"px"):(e.classList.remove("fixed"),e.style.paddingBottom="")}}function getCurrencyNum(e){e=String(e).split("").reverse();for(let t=3;t<e.length;t+=4)e.splice(t,0," ");return e.reverse().join("")}function createElem({tag:e="div",classNames:t,attrs:a,html:s}){const r=document.createElement(e);t&&t.forEach(e=>{r.classList.add(e)});for(let e in a)r.setAttribute(e,a[e]);return isNullableValue(s)||(r.innerHTML=s),r}function isNullableValue(e){if(e instanceof Array){for(let t=0;t<e.length;t++)if(null===e[t]||void 0===e[t]||!1===e[t])return!0}else if(null==e||!1===e)return!0;return!1}class Toast{constructor({selector:e,time:t,timeAnim:a}){this.selector=e||".toast",this.el=document.querySelector(this.selector),this.time=t||2500,this.timeAnim=a||500,this.isShowing=!1,this.timer=null,this.el&&this.setup()}showToast(){clearTimeout(this.timer),this.isShowing&&(this.el.classList.remove("show"),this.isShowing=!1),setTimeout(()=>{this.el.classList.add("show"),this.isShowing=!0},0),this.timer=setTimeout(()=>{this.el.classList.remove("show"),this.isShowing=!1,clearTimeout(this.timer)},this.time)}hideToast(){this.el.classList.remove("show"),clearTimeout(this.timer)}setup(){this.el.style.animationDuration=this.timeAnim/1e3+"s",this.el.addEventListener("click",e=>{this.hideToast()})}}const toastProductAdded=new Toast({selector:"#productAdded",timeAnim:300});class Cart{constructor({cartBtnSelector:e}){this.cartBtn=document.querySelector(e),this.outputSeparator="#",this.setup(),this.updateBtn()}updateBtn(){const e=this.cartBtn.querySelector("a.cart-btn__link"),t=this.getCartCount();t>0?(e.setAttribute("data-cart-count",t),this.cartBtn.classList.add("not-empty")):(e.removeAttribute("data-cart-count"),this.cartBtn.classList.remove("not-empty"))}addItem({id:e=null,title:t=null,price:a=null,count:s=null}){const r=this.getCart();if(isNullableValue([e,t,a,s]))throw new Error("Неверное значение для добавления товара в корзину");return r[e]={title:t,price:a,count:s},this.setCart(r),this.getCart()}increaseCount(e){const t=this.getCart();+t[e].count>=0?t[e].count+=1:t[e].count=0,this.setCart(t)}decreaseCount(e){const t=this.getCart();+t[e].count>0?t[e].count-=1:t[e].count=0,this.setCart(t)}removeItem(e){const t=this.getCart();return t[e]&&delete t[e],this.setCart(t),this.getCart()}getItem(e){const t=this.getCart();if(t[e])return t[e]}setCart(e){return localStorage.setItem("cart",JSON.stringify(e)),this.updateBtn(),this.getCart()}removeAll(){return this.setCart({}),this.getCart()}getCart(){return JSON.parse(localStorage.getItem("cart"))}getCartCount(){const e=this.getCart();let t=0;for(let a in e)t++;return t}getInputs(){const e=this.getCart(),t=[];for(let a in e){const s=e[a],r=createElem({tag:"input",attrs:{name:"cart-item-"+a,value:s.title+this.outputSeparator+s.count+this.outputSeparator+getCurrencyNum(s.price*s.count)+" руб",type:"hidden"}});t.push(r)}const a=createElem({tag:"input",attrs:{name:"total-sum",value:getCurrencyNum(this.getTotalSum())+" руб",type:"hidden"}}),s=createElem({tag:"input",attrs:{name:"separator",value:this.outputSeparator,type:"hidden"}});return t.push(a),t.push(s),t}getTotalSum(){const e=this.getCart();let t=0;for(let a in e)t+=e[a].price*e[a].count;return t}setup(){if(null==localStorage.getItem("cart")){let e={};e=JSON.stringify(e),localStorage.setItem("cart",e)}}}const cart=new Cart({cartBtnSelector:"#cartBtn"});class ProductCard{constructor(e){if("string"==typeof e)this.el=document.querySelector(e);else{if(!(e instanceof HTMLElement))throw new Error("Ошибка");this.el=e}this.btnMinus=this.el.querySelector('[name="cart-action"][value="minus"]'),this.btnPlus=this.el.querySelector('[name="cart-action"][value="plus"]'),this.input=this.el.querySelector(".product-item__cart-input"),this.btnAdd=this.el.querySelector(".product-item__cart-add"),this.id=this.el.getAttribute("data-id"),this.title=this.el.querySelector(".product-item__title").getAttribute("title"),this.price=this.el.querySelector(".product-item__price").getAttribute("data-price"),this.setup()}_validateDecimal(e){const t=[8,9,37,38,39,40,48,49,50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,104,105];e.addEventListener("keydown",e=>{t.includes(e.keyCode)||e.preventDefault()})}increase(){const e=this.input.value;isNaN(parseInt(e))?this.input.value=1:this.input.value=parseInt(e)+1}decrease(){const e=this.input.value;isNaN(parseInt(e))?this.input.value=0:parseInt(e)>0&&(this.input.value=parseInt(e)-1)}setup(){this._validateDecimal(this.input),this.btnPlus.addEventListener("click",e=>{this.increase()}),this.btnMinus.addEventListener("click",e=>{this.decrease()}),this.btnAdd.addEventListener("click",e=>{e.preventDefault();if(parseInt(this.input.value)>0){const e={id:this.id,count:parseInt(this.input.value),title:this.title,price:parseInt(this.price)};cart.addItem(e),toastProductAdded.showToast()}else alert("Уточните количество товара")})}}let activeModal=null;class Modal{constructor(e,{onCall:t}){this.selector=e,this.el=document.querySelector(this.selector),this.isInit=!1,this.el&&(this.isInit=!0,this.callBtn=document.querySelector('[data-call="'+this.el.getAttribute("id")+'"]'),this.onCall=t||function(){},this.overlay=this.el.querySelector(".modal__overlay"),this.closeBtn=this.el.querySelector(".modal__close"),this.setup())}showModal(e=!1){activeModal=this,e?this.el.classList.add("active"):(this.el.classList.remove("hiding"),this.el.classList.add("active"),this.el.classList.add("showing"),setTimeout(()=>{this.el.classList.remove("showing")},250)),document.body.classList.add("lock"),this.onCall()}hideModal(e=!1){activeModal=null,e?this.el.classList.remove("active"):(this.el.classList.remove("showing"),this.el.classList.add("hiding"),setTimeout(()=>{this.el.classList.remove("active"),this.el.classList.remove("hiding")},250)),document.body.classList.remove("lock")}showingHandler(){this.el.classList.contains("active")?this.hideModal():this.showModal()}setup(){this.closeBtn&&this.closeBtn.addEventListener("click",e=>{this.hideModal()}),this.overlay.addEventListener("mousedown",e=>{e.target===this.overlay&&this.hideModal()}),this.callBtn&&this.callBtn.addEventListener("click",e=>{this.showModal()})}}const callMe=new Modal("#callMe",{}),thankModal=new Modal("#thankModal",{}),cartConfirmDelete=new Modal("#cartConfirmDelete",{});cartConfirmDelete.isInit&&(cartConfirmDelete.btnConfirm=cartConfirmDelete.el.querySelector('[name="delete"][value="confirm"]'),cartConfirmDelete.btnCancel=cartConfirmDelete.el.querySelector('[name="delete"][value="cancel"]'),cartConfirmDelete.btnConfirm.addEventListener("click",e=>{cart.removeItem(cartConfirmDelete.deletingId),cartTable.updateTable(),cartConfirmDelete.deletingId=null,cartConfirmDelete.hideModal()}),cartConfirmDelete.btnCancel.addEventListener("click",e=>{cartConfirmDelete.hideModal()}));const cartConfirmClear=new Modal("#cartConfirmClear",{});cartConfirmClear.isInit&&(cartConfirmClear.btnConfirm=cartConfirmClear.el.querySelector('[name="clear"][value="confirm"]'),cartConfirmClear.btnCancel=cartConfirmClear.el.querySelector('[name="clear"][value="cancel"]'),cartConfirmClear.btnConfirm.addEventListener("click",e=>{cart.removeAll(),cartTable.updateTable(),cartConfirmClear.deletingId=null,cartConfirmClear.hideModal()}),cartConfirmClear.btnCancel.addEventListener("click",e=>{cartConfirmClear.hideModal()}));const btnClearCart=document.querySelector("#btnClearCart");btnClearCart&&btnClearCart.addEventListener("click",e=>{cartConfirmClear.showModal()});class CartTable{constructor(e,{emptyText:t}){this.wrapper=document.querySelector(e),this.table=document.querySelector(".cart__table"),this.preloader=document.querySelector(".sk-fading-circle"),this.emptyPlaceholderElem=document.querySelector(".cart-empty-placeholder"),this.totalOutput=document.querySelector(".cart__total .output"),this.emptyText=t||"",this.wrapper&&this.setup()}getTableRow(e){const t=createElem({tag:"tr",classNames:["cart__row"],attrs:{"data-id":e.id}}),a=["title","price","count"],s=[];for(let t=0;t<a.length;t++){const r=createElem({tag:"td",html:e[a[t]]});s.push(r)}s[1].innerText=getCurrencyNum(s[1].innerText)+" руб";const r=createElem({classNames:["cart__actions-col"]}),i=createElem({tag:"button",classNames:["cart__btn-more"]}),n=createElem({tag:"button",classNames:["cart__btn-less"]});i.addEventListener("click",t=>{cart.increaseCount(e.id),this.updateTable()}),n.addEventListener("click",t=>{cart.decreaseCount(e.id),this.updateTable()}),r.append(i,n),s[2].append(r);const l=parseInt(e.price)*parseInt(e.count);s.push(createElem({tag:"td",html:getCurrencyNum(l)+" руб"}));const o=createElem({tag:"button",classNames:["cart__delete"],attrs:{title:"Удалить"},html:'<img src="assets/img/icon/remove.svg" alt="Удалить">'});return o.addEventListener("click",t=>{cartConfirmDelete.showModal(),document.querySelector(".cart-removing-title").innerText=e.title,cartConfirmDelete.deletingId=e.id}),s.push(createElem({tag:"td"})),s[4].append(o),t.append(...s),t}showLoader(){this.wrapper.classList.add("hidden"),this.emptyPlaceholderElem.classList.add("hidden"),this.preloader.classList.remove("hidden")}showPlaceholder(){this.wrapper.classList.add("hidden"),this.preloader.classList.add("hidden"),this.emptyPlaceholderElem.classList.remove("hidden"),this.emptyPlaceholderElem.innerText=this.emptyText}showTable(){this.emptyPlaceholderElem.classList.add("hidden"),this.preloader.classList.add("hidden"),this.wrapper.classList.remove("hidden")}checkContent(){return cart.getCartCount()>0?(this.showTable(),!0):(this.showPlaceholder(),!1)}updateTable(){if(this.checkContent()){const e=cart.getCart(),t=this.table.querySelector("tbody");t.innerHTML="";for(let a in e){const s={id:a,price:e[a].price,title:e[a].title,count:e[a].count};t.append(this.getTableRow(s))}this.updateTotalSum()}}updateTotalSum(){const e=cart.getCart();let t=0;for(let a in e){t+=e[a].count*e[a].price}t=getCurrencyNum(t),this.totalOutput.innerText=t+" руб"}setup(){this.updateTable()}}const cartTable=new CartTable(".cart-content-wrapper",{emptyText:"Ваша корзина на данный момент пуста"});function removeHiddenInputs(e){e.querySelectorAll('input[type="hidden"]').forEach(e=>{"form-type"!==e.getAttribute("name")&&e.remove()})}function sendCartForm(e,t=null){t=t||function(){},event.preventDefault();const a=e.querySelector('input[name="policy"]');if(!isNullableValue(a)&&!a.checked)return alert("Мы не можем принять заявку без вашего согласия с политикой конфиденциальности"),!1;if(validateForm(e)){removeHiddenInputs(e),e.append(...cart.getInputs());var s=new XMLHttpRequest,r=serialize(e);s.open("POST","./mail.php"),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.onreadystatechange=function(){4==s.readyState&&200==s.status&&(e.reset(),t(),activeModal&&activeModal.hideModal(),thankModal.showModal())},s.send(r)}else alert("Введите корректные данные")}function sendForm(e,t=null){t=t||function(){},event.preventDefault();const a=e.querySelector('input[name="policy"]');if(!isNullableValue(a)&&!a.checked)return alert("Мы не можем принять заявку без вашего согласия с политикой конфиденциальности"),!1;if(validateForm(e)){var s=new XMLHttpRequest,r=serialize(e);console.log(r),s.open("POST","./mail.php"),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.onreadystatechange=function(){4==s.readyState&&200==s.status&&(e.reset(),t(),activeModal&&activeModal.hideModal(),thankModal.showModal())},s.send(r)}else alert("Введите корректные данные")}function validateForm(e){var t=e.querySelector('input[name="tel"]'),a=e.querySelector('input[name="name"]'),s=!0;return t&&!t.value.match(/^((8|\+7)[\- ]?)?(\(?\d{3}\)?[\- ]?)?[\d\- ]{7,10}$/)&&(s=!1),a&&a.value.length<2&&(s=!1),s}function serialize(e){if(!e||"FORM"!==e.nodeName)return!1;var t,a,s=[];for(t=e.elements.length-1;t>=0;t-=1)if(""!==e.elements[t].name)switch(e.elements[t].nodeName){case"INPUT":switch(e.elements[t].type){case"text":case"tel":case"email":case"hidden":case"password":case"button":case"reset":case"submit":s.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].value));break;case"checkbox":case"radio":e.elements[t].checked&&s.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].value))}break;case"file":break;case"TEXTAREA":s.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].value));break;case"SELECT":switch(e.elements[t].type){case"select-one":s.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].value));break;case"select-multiple":for(a=e.elements[t].options.length-1;a>=0;a-=1)e.elements[t].options[a].selected&&s.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].options[a].value))}break;case"BUTTON":switch(e.elements[t].type){case"reset":case"submit":case"button":s.push(e.elements[t].name+"="+encodeURIComponent(e.elements[t].value))}}return s.join("&")}if(document.querySelector(".product-item")){document.querySelectorAll(".product-item").forEach(e=>{new ProductCard(e)})}
//# sourceMappingURL=maps/main.min.js.map
