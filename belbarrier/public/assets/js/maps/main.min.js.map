{"version":3,"sources":["main.js"],"names":["GateForm","selector","_ref","onSubmit","_classCallCheck","this","el","document","querySelector","btn","setup","inputs","querySelectorAll","allow","forEach","input","name","getAttribute","checked","value","length","data","createElement","setAttribute","key","push","_this","addEventListener","e","preventDefault","getFormData","getInputs","inp","appendChild","Modal","overlay","closeBtn","_this2","disableAnimation","arguments","undefined","classList","add","remove","body","_this3","setTimeout","contains","hideModal","showModal","_this4","target","sendForm","form","onSuccess","event","validateForm","xhr","XMLHttpRequest","serialize","console","log","setRequestHeader","onreadystatechange","readyState","status","reset","alert","send","inputTel","inputName","match","nodeName","i","j","q","elements","type","encodeURIComponent","writeCommaCheckbox","open","options","selected","regTel","ownModal","callModal","showModalCallBtn"],"mappings":"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","file":"../main.min.js","sourcesContent":["class GateForm {\r\n    constructor(selector, {onSubmit}) {\r\n        this.el = document.querySelector(selector);\r\n        this.btn = this.el.querySelector('.gate-form__submit');\r\n        this.onSubmit = onSubmit || function(){};\r\n        this.setup();\r\n    }\r\n    getFormData() {\r\n        const inputs = this.el.querySelectorAll('input');\r\n        // const names = new Set();\r\n        const data = {};\r\n        let allow = true;\r\n        inputs.forEach(input => {\r\n            const name = input.getAttribute('name');\r\n            // names.add(name);\r\n            if ((input.getAttribute('type') === 'checkbox' || input.getAttribute('type') === 'radio') && input.checked) {\r\n                data[name] = input.value;\r\n            } else if ((input.getAttribute('type') === 'number' || input.getAttribute('type') === 'text') && input.value.length > 0) {\r\n                data[name] = input.value;\r\n            }\r\n\r\n        });\r\n        inputs.forEach(input => {\r\n            const name = input.getAttribute('name');\r\n            if (!data[name] && input.getAttribute('type') !== 'checkbox') {\r\n                allow = false;\r\n            }\r\n        });\r\n        return allow ? data : false;\r\n    }\r\n    getInputs(data) {\r\n        const inputs = [];\r\n        for (let key in data) {\r\n            const input = document.createElement('input');\r\n            input.setAttribute('type', 'hidden');\r\n            input.setAttribute('name', key);\r\n            input.setAttribute('value', data[key]);\r\n            inputs.push(input);\r\n        }\r\n        return inputs;\r\n    }\r\n    setup() {\r\n        this.el.addEventListener('submit', e => {\r\n            e.preventDefault();\r\n            const data = this.getFormData();\r\n            let inputs = data ? this.getInputs(data) : null;\r\n            if (inputs) {\r\n                inputs.forEach(inp => {\r\n                    document.querySelector('#ownForm form').appendChild(inp);\r\n                });\r\n                this.onSubmit();\r\n            } else {\r\n                alert('Выбраны не все значения!');\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nclass Modal {\r\n    constructor(selector) {\r\n        this.selector = selector;\r\n        this.el = document.querySelector(this.selector);\r\n        if (this.el) {\r\n            // this.onSubmit = onSubmit || function(){};\r\n            this.overlay = this.el.querySelector('.modal__overlay');\r\n            this.closeBtn = this.el.querySelector('.modal__close');\r\n            this.setup();\r\n        }\r\n    }\r\n    showModal(disableAnimation = false) {\r\n        if (disableAnimation) {\r\n            this.el.classList.add('active');\r\n        } else {\r\n            this.el.classList.remove('hiding');\r\n            this.el.classList.add('active');\r\n            this.el.classList.add('showing');\r\n            setTimeout(() => {\r\n                this.el.classList.remove('showing');\r\n            }, 250);\r\n        }\r\n        document.body.classList.add('lock');\r\n    }\r\n    hideModal(disableAnimation = false) {\r\n        if (disableAnimation) {\r\n            this.el.classList.remove('active');\r\n        } else {\r\n            this.el.classList.remove('showing');\r\n            this.el.classList.add('hiding');\r\n            setTimeout(() => {\r\n                this.el.classList.remove('active');\r\n                this.el.classList.remove('hiding');\r\n            }, 250);\r\n        }\r\n        document.body.classList.remove('lock');\r\n    }\r\n    showingHandler() {\r\n        this.el.classList.contains('active') ?\r\n            this.hideModal() :\r\n            this.showModal();\r\n    }\r\n    setup() {\r\n        this.closeBtn.addEventListener('click', (e) => {\r\n            this.hideModal();\r\n        });\r\n        this.overlay.addEventListener('mousedown', (e) => {\r\n            if (e.target === this.overlay) {\r\n                this.hideModal();\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n\r\n\r\nfunction sendForm(form, onSuccess = null) {\r\n    onSuccess = onSuccess || function(){};\r\n    event.preventDefault();\r\n    if (validateForm(form)) {\r\n        alert('Данные отправлены');\r\n\r\n        var xhr = new XMLHttpRequest();\r\n        var body = serialize(form);\r\n        console.log(body);\r\n        xhr.open('POST', './mail.php');\r\n        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n        xhr.onreadystatechange = function() {\r\n            if (xhr.readyState == 4 && xhr.status == 200) {\r\n                form.reset();\r\n                onSuccess();\r\n                alert('Данные отправлены');\r\n\r\n            }\r\n        };\r\n        xhr.send(body);\r\n    } else {\r\n        alert('Введите корректные данные');\r\n    }\r\n}\r\nfunction validateForm(form) {\r\n\tvar regTel = /^((8|\\+7)[\\- ]?)?(\\(?\\d{3}\\)?[\\- ]?)?[\\d\\- ]{7,10}$/;\r\n\tvar inputTel = form.querySelector('input[name=\"tel\"]');\r\n    var inputName = form.querySelector('input[name=\"name\"]');\r\n    var allow = true;\r\n    if (inputTel && !inputTel.value.match(regTel)) allow = false;\r\n    if (inputName && inputName.value.length < 2) allow = false;\r\n    return allow;\r\n}\r\nfunction serialize(form) {\r\n\tif (!form || form.nodeName !== \"FORM\") {\r\n\t\treturn false;\r\n\t}\r\n\tvar i, j, q = [];\r\n\tfor (i = form.elements.length - 1; i >= 0; i = i - 1) {\r\n\t\tif (form.elements[i].name === \"\") {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tswitch (form.elements[i].nodeName) {\r\n\t\t\tcase 'INPUT':\r\n\t\t\t\tswitch (form.elements[i].type) {\r\n\t\t\t\t\tcase 'text':\r\n\t\t\t\t\tcase 'tel':\r\n\t\t\t\t\tcase 'email':\r\n\t\t\t\t\tcase 'hidden':\r\n\t\t\t\t\tcase 'password':\r\n\t\t\t\t\tcase 'button':\r\n\t\t\t\t\tcase 'reset':\r\n\t\t\t\t\tcase 'submit':\r\n\t\t\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].value));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'checkbox':\r\n\t\t\t\t\t\twriteCommaCheckbox(form, i, q);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'radio':\r\n\t\t\t\t\t\tif (form.elements[i].checked) {\r\n\t\t\t\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].value));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'file':\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'TEXTAREA':\r\n\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].value));\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'SELECT':\r\n\t\t\t\tswitch (form.elements[i].type) {\r\n\t\t\t\t\tcase 'select-one':\r\n\t\t\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].value));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'select-multiple':\r\n\t\t\t\t\t\tfor (j = form.elements[i].options.length - 1; j >= 0; j = j - 1) {\r\n\t\t\t\t\t\t\tif (form.elements[i].options[j].selected) {\r\n\t\t\t\t\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].options[j].value));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'BUTTON':\r\n\t\t\t\tswitch (form.elements[i].type) {\r\n\t\t\t\t\tcase 'reset':\r\n\t\t\t\t\tcase 'submit':\r\n\t\t\t\t\tcase 'button':\r\n\t\t\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].value));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\treturn q.join(\"&\");\r\n}\r\n\r\nconst ownModal = new Modal('#ownForm', {});\r\nconst callModal = new Modal('#callMe', {});\r\nconst ownGateForm = new GateForm('.own .gate-form', {\r\n    onSubmit: function() {\r\n        ownModal.showModal();\r\n    }\r\n});\r\n\r\nconst showModalCallBtn = document.querySelector('#showModalCall');\r\nshowModalCallBtn.addEventListener('click', function() {\r\n    callModal.showModal();\r\n});"]}