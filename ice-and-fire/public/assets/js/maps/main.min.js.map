{"version":3,"names":[],"mappings":"","sources":["main.js"],"sourcesContent":["'use strict';\r\nconst pageNames = {\r\n    product: 'product',\r\n    catalog: 'catalog',\r\n    index: 'index'\r\n};\r\n\r\nfunction markActivePage() {\r\n    const path = window.location.pathname;\r\n    const navMenuLinks = document.querySelectorAll('.nav-list .nav-list__item a');\r\n    navMenuLinks.forEach(function(el) {\r\n        const href = el.getAttribute('href');\r\n        path.match(href) ? el.closest('.nav-list__item').classList.add('current') : void (0);\r\n        if ((path === '' || path === '/') && (href.indexOf('index') > -1)) {el.closest('.nav-list__item').classList.add('current')}\r\n    });\r\n}\r\n\r\nfunction nodeExist(selector) {\r\n    return document.querySelector(selector) !== null;\r\n}\r\nfunction getNewNode({tag = 'div', classList = '', attrs = {}, html, text}) {\r\n    const elem = document.createElement(tag);\r\n    elem.classList = classList;\r\n    for (let key in attrs) {\r\n        elem.setAttribute(key, attrs[key]);\r\n    }\r\n    if (html) {elem.innerHTML = html}\r\n    if (text) {elem.innerText = text}\r\n    return elem;\r\n}\r\n\r\nfunction setLabelUp() {\r\n    const elems = document.querySelectorAll('.label-up');\r\n    elems.forEach(el => {\r\n        const input = el.querySelector('input');\r\n        input.setAttribute('placeholder', ' ');\r\n    });\r\n}\r\n\r\nfunction serialize(form) {\r\n\tif (!form || form.nodeName !== \"FORM\") {\r\n\t\treturn false;\r\n\t}\r\n\tvar i, j, q = [];\r\n\tfor (i = form.elements.length - 1; i >= 0; i = i - 1) {\r\n\t\tif (form.elements[i].name === \"\") {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tswitch (form.elements[i].nodeName) {\r\n\t\t\tcase 'INPUT':\r\n\t\t\t\tswitch (form.elements[i].type) {\r\n\t\t\t\t\tcase 'text':\r\n\t\t\t\t\tcase 'tel':\r\n\t\t\t\t\tcase 'email':\r\n\t\t\t\t\tcase 'hidden':\r\n\t\t\t\t\tcase 'password':\r\n\t\t\t\t\tcase 'button':\r\n\t\t\t\t\tcase 'reset':\r\n\t\t\t\t\tcase 'submit':\r\n\t\t\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].value));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'checkbox':\r\n\t\t\t\t\t\twriteCommaCheckbox(form, i, q);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'radio':\r\n\t\t\t\t\t\tif (form.elements[i].checked) {\r\n\t\t\t\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].value));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'file':\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'TEXTAREA':\r\n\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].value));\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'SELECT':\r\n\t\t\t\tswitch (form.elements[i].type) {\r\n\t\t\t\t\tcase 'select-one':\r\n\t\t\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].value));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'select-multiple':\r\n\t\t\t\t\t\tfor (j = form.elements[i].options.length - 1; j >= 0; j = j - 1) {\r\n\t\t\t\t\t\t\tif (form.elements[i].options[j].selected) {\r\n\t\t\t\t\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].options[j].value));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'BUTTON':\r\n\t\t\t\tswitch (form.elements[i].type) {\r\n\t\t\t\t\tcase 'reset':\r\n\t\t\t\t\tcase 'submit':\r\n\t\t\t\t\tcase 'button':\r\n\t\t\t\t\t\tq.push(form.elements[i].name + \"=\" + encodeURIComponent(form.elements[i].value));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\treturn q.join(\"&\");\r\n}\r\n\r\nfunction validateForm(form) {\r\n\tvar regTel = /^((8|\\+7)[\\- ]?)?(\\(?\\d{3}\\)?[\\- ]?)?[\\d\\- ]{7,10}$/;\r\n\tvar inputTel = form.querySelector('input[name=\"tel\"]');\r\n    var inputName = form.querySelector('input[name=\"name\"]');\r\n    return (!!inputTel.value.match(regTel) && inputName.value.length >= 2);\r\n}\r\n\r\nclass Tabs {\r\n    constructor({tabsSelector, tabSelector, onInit, withContent, initialTab}) {\r\n        this.selector = tabsSelector || '.tabs';\r\n        this.tabSelector = tabSelector || '.tabs__item';\r\n        // this.tabsWrapperSelector = tabsWrapperSelector;\r\n        this.tabs = document.querySelectorAll(this.selector + ' ' + this.tabSelector);\r\n        this.inputs = document.querySelectorAll(this.selector + ' input');\r\n        this.initialTab = initialTab || 0;\r\n        this.contents = null;\r\n        this.withContent = withContent || false;\r\n        this.data = {\r\n            activeIdx: null,\r\n            activeValue: null\r\n        };\r\n        this.isInit = false;\r\n        this.onInit = onInit ? onInit.bind(this) : function(){return false};\r\n        this.setup();\r\n    }\r\n    resetTabs() {\r\n        this.tabs.forEach(function(el) {\r\n            el.classList.remove('active');\r\n        });\r\n    }\r\n    _onInit() {\r\n        if (this.onInit()) {\r\n            this.onInit();\r\n        }\r\n    }\r\n    setupContent() {\r\n        if (this.withContent) {\r\n            this.contents = document.querySelectorAll('[data-content-for-tab]');\r\n        }\r\n    }\r\n    resetContents() {\r\n        this.inputs.forEach(function(el) {\r\n            const name = el.getAttribute('value');\r\n            const content = document.querySelector('[data-content-for-tab=\"'+ name +'\"]');\r\n            content.classList.remove('active');\r\n        });\r\n    }\r\n    setContent(name) {\r\n        this.resetContents();\r\n        const content = document.querySelector('[data-content-for-tab=\"'+ name +'\"]');\r\n        content.classList.add('active');\r\n    }\r\n    setup() {\r\n        if (document.querySelector(this.selector) !== null) {\r\n            this.inputs.forEach((el, idx) => {\r\n                el.addEventListener('change', (e) => {\r\n                    this.data = {activeIdx:idx, activeValue:el.value};\r\n                    this.resetTabs();\r\n                    this.tabs[idx].classList.add('active');\r\n                    if (this.withContent) {\r\n                        this.setContent(el.getAttribute('value'));\r\n                    }\r\n                });\r\n            });\r\n            this.tabs[this.initialTab].classList.add('active');\r\n            this.inputs[this.initialTab].checked = true;\r\n            if (this.withContent) {this.setContent(this.inputs[this.initialTab].getAttribute('value'))}\r\n            this.isInit = true;\r\n            this._onInit();\r\n        }\r\n    }\r\n}\r\n\r\nclass MenuCatalog {\r\n    constructor({menuSelector}) {\r\n        this.menuSelector = menuSelector;\r\n        this.menuRoot = document.querySelector(menuSelector);\r\n        this.menuBtn = this.menuRoot.querySelector('a');\r\n        this.setup();\r\n    }\r\n    setup() {\r\n        if (this.menuRoot !== null) {\r\n            const root = this.menuRoot;\r\n            const btn = this.menuBtn;\r\n            const selector = this.menuSelector;\r\n\r\n            root.addEventListener('click', function(e) {\r\n                e.preventDefault();\r\n                if (e.target.closest('a') === btn) {\r\n                    root.classList.contains('active') ?\r\n                        root.classList.remove('active') :\r\n                        root.classList.add('active');\r\n                }\r\n\r\n            });\r\n            document.addEventListener('click', function(e) {\r\n                if (e.target.closest(selector) !== root) {\r\n                    root.classList.remove('active');\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nclass ProductCards {\r\n    constructor({cardSelector}) {\r\n        this.cardSelector = cardSelector;\r\n        this.cardElems = document.querySelectorAll(this.cardSelector);\r\n        if (this.cardElems.length > 0) {\r\n            this.setup();\r\n        }\r\n    }\r\n    addToCartHandler() {\r\n\r\n    }\r\n    _setupSaleLabels() {\r\n        this.cardElems.forEach(el => {\r\n            if (el.classList.contains('sale')) {\r\n                const label = getNewNode({\r\n                    classList: 'product-card__sale-label',\r\n                    attrs: {\r\n                        'data-tooltip': 'Товар со скидкой',\r\n                        'data-side': 'right',\r\n                    }\r\n                });\r\n                el.appendChild(label);\r\n            }\r\n        });\r\n    }\r\n    _setupAddBtnAction() {\r\n        this.cardElems.forEach((el, idx) => {\r\n            const addBtn = el.querySelector(this.cardSelector + '__add');\r\n            addBtn.onclick = () => {el.classList.toggle('in-cart')};\r\n        });\r\n    }\r\n    setup() {\r\n        this._setupAddBtnAction();\r\n        this._setupSaleLabels();\r\n    }\r\n}\r\n\r\nclass SearchField {\r\n    constructor({formSelector}) {\r\n        this.formSelector = formSelector;\r\n        this.form = document.querySelector(formSelector);\r\n        this.input = document.querySelector(formSelector + ' input');\r\n        this.btn = document.querySelector(formSelector + ' button');\r\n        this.isInit = false;\r\n        this.state = null;\r\n        this.inputPlaceholder = null;\r\n        this.text = '';\r\n        this.setup();\r\n    }\r\n    openForm() {\r\n        this.form.classList.remove('close');\r\n        this.form.classList.add('open');\r\n    }\r\n    closeForm() {\r\n        this.form.classList.remove('open');\r\n        this.form.classList.add('close');\r\n    }\r\n    btnHandler(e) {\r\n        if (!this.text) {\r\n            e.preventDefault();\r\n            if (this.state === 'open') {\r\n                this.state = 'close';\r\n                this.closeForm();\r\n            } else if (this.state === 'close') {\r\n                this.state = 'open';\r\n                this.openForm();\r\n            }\r\n        } else {\r\n            alert('Имитация поиска товара по запросу: ' + this.text);\r\n            this.form.submit();\r\n        }\r\n    }\r\n    inputHandler(e) {\r\n        this.text = e.target.value;\r\n        // if (!this.text && e.key === 'Enter') {\r\n        //     e.preventDefault();\r\n        // } else if (this.text && e.key === 'Enter') {\r\n        //     alert('Имитация поиска товара по запросу: ' + this.text);\r\n        // }\r\n    }\r\n    setup() {\r\n        if (this.form && this.input && this.btn) {\r\n            this.state = 'close';\r\n            this.inputPlaceholder = this.input.getAttribute('placeholder');\r\n            const btnHandler = this.btnHandler.bind(this);\r\n            const inputHandler = this.inputHandler.bind(this);\r\n            // const formHandler = this.formHandler.bind(this);\r\n            this.btn.addEventListener('click', function(e) {btnHandler(e)});\r\n            this.input.addEventListener('input', function(e) {inputHandler(e)});\r\n            this.form.addEventListener('submit', (e) => {\r\n                if (!this.text) {\r\n                    e.preventDefault();\r\n                } else {\r\n                    alert('Имитация поиска товара по запросу: ' + this.text);\r\n                }\r\n            });\r\n\r\n            this.isInit = true;\r\n        } else {\r\n            console.error('SearchField not inited. Some of elements not found');\r\n        }\r\n    }\r\n}\r\n\r\nclass Filter {\r\n    constructor(selector, {classnames}) {\r\n        this.selector = selector;\r\n        this.el = document.querySelector(this.selector);\r\n        this.cn = classnames;\r\n        if (this.el) {\r\n            this.titles = this.el.querySelectorAll(this.cn.titles);\r\n            this.cats = this.el.querySelectorAll(this.cn.cats);\r\n            this.catsNames = [];\r\n            this.cats.forEach(cat => {this.catsNames.push(cat.getAttribute('data-filter-cat'))});\r\n            // this.priceInputs = this.el.querySelectorAll('input[name^=price]');\r\n            // this.widthInputs = this.el.querySelectorAll('input[name^=width]');\r\n            // this.depthInputs = this.el.querySelectorAll('input[name^=depth]');\r\n            this.btnsReset = this.el.querySelectorAll('button[name=reset]');\r\n        }\r\n        if (this.el && nodeExist('.btn-up a[href=\"#' + this.el.getAttribute('id') + '\"]')) {\r\n            this.btnUp = document.querySelector('.btn-up');\r\n        }\r\n        this.btnUpIsShown = false;\r\n        /* данные */\r\n        this.brands = new Set();\r\n        this.brands.reset = function() {this.clear()}\r\n        /* ====== */\r\n\r\n        if (this.el) {\r\n            this.setup();\r\n        }\r\n    }\r\n    checkClosestLi(child) {\r\n        child.closest('li').classList.add('checked');\r\n    }\r\n    uncheckClosestLi(child) {\r\n        child.closest('li').classList.remove('checked');\r\n    }\r\n    checkCollapsable(child) {\r\n        const parent = child.closest('li.collapsable');\r\n        if (!parent) return;\r\n        const input = parent.querySelector('input[type=\"checkbox\"]');\r\n        if (!input.checked) {\r\n            input.checked = true;\r\n            parent.classList.add('checked');\r\n        }\r\n    }\r\n    uncheckCollapsable(child) {\r\n        const parent = child.closest('li.collapsable');\r\n        if (!parent) return;\r\n        const input = parent.querySelector('input[type=\"checkbox\"]');\r\n\r\n        const sublistInputs = parent.querySelectorAll('.filter__sublist input[type=\"checkbox\"]');\r\n        let checkedCount = 0;\r\n        sublistInputs.forEach(inp => {\r\n            if (inp.checked) checkedCount++;\r\n        });\r\n        if (checkedCount == 0) {\r\n            input.checked = false;\r\n            parent.classList.remove('checked');\r\n        }\r\n    }\r\n    uncheckCurrentCollapsable(child) {\r\n        const li = child.closest('li.collapsable');\r\n        const isSublist = !!child.closest('.filter__sublist');\r\n        if (!li || isSublist) return;\r\n        const catName = li.closest('[data-filter-cat]').getAttribute('data-filter-cat');\r\n\r\n        let checkedCount = 0;\r\n        const innerInputs = li.querySelectorAll('.filter__sublist input[type=\"checkbox\"]');\r\n        innerInputs.forEach(inp => {\r\n            if (inp.checked) checkedCount++;\r\n        });\r\n        if (checkedCount > 0) {\r\n            innerInputs.forEach(inp => {\r\n                if (inp.checked) {\r\n                    inp.checked = false;\r\n                    this.uncheckClosestLi(inp);\r\n                    this[catName].delete(inp.value);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    checkCurrentCollapsable(child) {\r\n        const li = child.closest('li.collapsable');\r\n        const isSublist = !!child.closest('.filter__sublist');\r\n        if (!li || isSublist) return;\r\n        const catName = li.closest('[data-filter-cat]').getAttribute('data-filter-cat');\r\n        this[catName].delete(child.value);\r\n\r\n        const innerInputs = li.querySelectorAll('.filter__sublist input[type=\"checkbox\"]');\r\n        child.checked = true;\r\n        this.checkClosestLi(child);\r\n        innerInputs.forEach(inp => {\r\n            inp.checked = true;\r\n            this.checkClosestLi(inp);\r\n            this[catName].add(inp.value);\r\n        });\r\n    }\r\n    toggleBtnReset(cat, show) {\r\n        const btn = cat.querySelector('button[name=reset]');\r\n        show ? btn.classList.add('shown') : btn.classList.remove('shown');\r\n    }\r\n    _validateDecimal(nodes) {\r\n        /* валидация нажатой кнопки на соответствие цифре или кнопке управления (напр. tab или стрелка) */\r\n        const validCodes = [\r\n            8,9,\r\n            37,38,39,40,\r\n            48,49,50,51,52,53,54,55,56,57,\r\n            96,97,98,99,100,101,102,103,104,105\r\n        ];\r\n        nodes.forEach(el => {\r\n            el.addEventListener('keydown', e => {\r\n                if (!validCodes.includes(e.keyCode)) {\r\n                    e.preventDefault();\r\n                }\r\n            });\r\n        });\r\n    }\r\n    _setupRangeFields(catName) {\r\n        /* сохранение введенных данных в массиве */\r\n        this[catName] = [0, 0];\r\n        this[catName].reset = function() {\r\n            this[0] = 0;\r\n            this[1] = 0;\r\n        };\r\n        const inputs = this.el.querySelectorAll('input[name^=' + catName + ']');\r\n        \r\n        inputs.forEach(input => {\r\n            input.addEventListener('input', e => {\r\n                const t = e.target;\r\n                if (parseInt(t.value) === 0) {t.value = '0'}\r\n                const name = t.getAttribute('name');\r\n                switch (name) {\r\n                    case (catName + '-from'):\r\n                        this[catName][0] = +t.value;\r\n                        break;\r\n                    case (catName + '-to'):\r\n                        this[catName][1] = +t.value;\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n                const willShowBtn = (this[catName][0] || this[catName][1]);\r\n                this.toggleBtnReset(input.closest('.filter__cat'), willShowBtn);\r\n            });\r\n        });\r\n    }\r\n    _setupTitles() {\r\n        this.titles.forEach((el, idx) => {\r\n            el.addEventListener('click', e => {\r\n                if (e.target === el || e.target === el.querySelector('span')) {\r\n                    this.cats[idx].classList.toggle('hidden');\r\n                }\r\n            });\r\n        });\r\n    }\r\n    _setupListTitles() {\r\n        const listItems = this.el.querySelectorAll('.filter__list > li');\r\n        listItems.forEach(li => {\r\n            if (li.querySelector('.filter__sublist')) {\r\n                const arrow = document.createElement('div');\r\n                arrow.classList.add('filter__list-arrow');\r\n                li.classList.add('collapsable');\r\n                li.append(arrow);\r\n            }\r\n        });\r\n        const arrows = this.el.querySelectorAll('.filter__list-arrow');\r\n        arrows.forEach(ar => {\r\n            ar.addEventListener('click', e => {\r\n                ar.closest('li.collapsable').querySelector('.filter__sublist').classList.toggle('hidden');\r\n            });\r\n        });\r\n    }\r\n    resetInputs(inputs) {\r\n        inputs.forEach(input => {\r\n            const type = input.getAttribute('type');\r\n            switch (type) {\r\n                case 'text':\r\n                case 'number':\r\n                case 'search':\r\n                    input.value = '';\r\n                    break;\r\n                case 'checkbox':\r\n                case 'radio':\r\n                    if (input.getAttribute('name') === 'brands') {\r\n                        this.deleteAllBrands();\r\n                    } else {\r\n                        input.checked = false;\r\n                    }\r\n                    this.uncheckClosestLi(input);\r\n                    this.showClosestLi(input);\r\n                default:\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n    _setupBtnsReset() {\r\n        this.btnsReset.forEach(btn => {\r\n            btn.addEventListener('click', e => {\r\n                const catName = e.target.getAttribute('value');\r\n                let inputs;\r\n                e.preventDefault();\r\n                if (catName === 'all') {\r\n                    inputs = this.el.querySelectorAll('input');\r\n                    this.cats.forEach(cat => {\r\n                        const name = cat.getAttribute('data-filter-cat');\r\n                        this[name].reset();\r\n                        this.toggleBtnReset(cat, false);\r\n                    });\r\n                } else {\r\n                    inputs = this.el.querySelectorAll('.filter__cat[data-filter-cat=' + catName + '] input');\r\n                    this[catName].reset();\r\n                    this.toggleBtnReset(btn.closest('.filter__cat'), false);\r\n                }\r\n                this.resetInputs(inputs);\r\n            });\r\n        });\r\n    }\r\n    _setupOtherCats() {\r\n        this.cats.forEach(cat => {\r\n            const catName = cat.getAttribute('data-filter-cat');\r\n            if (this[catName]) return;\r\n\r\n            this[catName] = new Set();\r\n            this[catName].reset = function() {this.clear()};\r\n            \r\n            const inputs = cat.querySelectorAll('input');\r\n            if (inputs[0].getAttribute('type') === 'checkbox') {\r\n                this._setupOtherInputsCb(inputs, catName);\r\n            }\r\n        });\r\n    }\r\n    _setupOtherInputsCb(inputs, catName) {\r\n        inputs.forEach(input => {\r\n            input.addEventListener('change', e => {\r\n                if (input.checked) {\r\n                    this[catName].add(input.value);\r\n                    this.checkClosestLi(input);\r\n                    this.checkCollapsable(input);\r\n                    this.checkCurrentCollapsable(input);\r\n                } else {\r\n                    this[catName].delete(input.value);\r\n                    this.uncheckClosestLi(input);\r\n                    this.uncheckCollapsable(input);\r\n                    this.uncheckCurrentCollapsable(input);\r\n                }\r\n                // input.checked ?\r\n                //     this[catName].add(input.value) :\r\n                //     this[catName].delete(input.value);\r\n                const willShowBtn = this[catName].size > 0;\r\n                this.toggleBtnReset(input.closest('.filter__cat'), willShowBtn);\r\n            });\r\n        });\r\n    }\r\n    showClosestLi(child) {\r\n        child.closest('li').classList.remove('hidden');\r\n    }\r\n    hideClosestLi(child) {\r\n        child.closest('li').classList.add('hidden');\r\n    }\r\n    _setupBrands() {\r\n        const catElem = this.el.querySelector('[data-filter-cat=brands]');\r\n        if (!catElem) return;\r\n        const searchInput = catElem.querySelector('input[name=brand-search]');\r\n        const checkboxes = catElem.querySelectorAll('input[type=checkbox]');\r\n        // Поле поиска\r\n        searchInput.addEventListener('input', e => {\r\n            const t = e.target;\r\n            const text = t.value;\r\n            checkboxes.forEach(cb => {\r\n                cb.getAttribute('value').toLowerCase().includes(text.toLowerCase()) ?\r\n                    this.showClosestLi(cb) :\r\n                    this.hideClosestLi(cb);\r\n            });\r\n        });\r\n\r\n        // Обработка чекбоксов\r\n        checkboxes.forEach(input => {\r\n            input.addEventListener('change', e => {\r\n                const val = input.getAttribute('value');\r\n                if (input.checked) {\r\n                    this.addBrand(val);\r\n                    this.checkClosestLi(input);\r\n                } else {\r\n                    this.deleteBrand(val);\r\n                    this.uncheckClosestLi(input);\r\n                }\r\n                // input.checked ? this.addBrand(val) : this.deleteBrand(val);\r\n                const willShowBtn = this.brands.size > 0;\r\n                this.toggleBtnReset(catElem, willShowBtn);\r\n\r\n            });\r\n        });\r\n    }\r\n    addBrand(val) {\r\n        const tagsContainer = document.querySelector('.catalog__brand-tags');\r\n        const tag = this._getBrandTag(val);\r\n        tagsContainer.append(tag);\r\n        this.brands.add(val);\r\n    }\r\n    deleteBrand(val) {\r\n        const input = document.querySelector('[data-filter-cat=brands] input[value=\"' + val + '\"]');\r\n        const tag = document.querySelector('.catalog__brand-tag[data-brand=\"' + val + '\"]');\r\n        input.checked = false;\r\n        this.uncheckClosestLi(input);\r\n        tag.remove();\r\n        this.brands.delete(val);\r\n        if (this.brands.size === 0) {\r\n            this.toggleBtnReset(input.closest('.filter__cat'), false);\r\n        }\r\n    }\r\n    deleteAllBrands() {\r\n        const brands = document.querySelectorAll('.catalog__brand-tag');\r\n        brands.forEach(brand => {\r\n            this.deleteBrand(brand.getAttribute('data-brand'));\r\n        });\r\n    }\r\n    _getBrandTag(val) {\r\n        const tag = getNewNode({\r\n            classList: 'catalog__brand-tag',\r\n            attrs: {'data-brand': val}\r\n        });\r\n        const btn = getNewNode({\r\n            tag: 'button',\r\n            classList: 'catalog__brand-delete',\r\n            attrs: {'type': 'button'},\r\n            html: '&#10006'\r\n        });\r\n        const span = getNewNode({\r\n            tag: 'span',\r\n            text: val,\r\n        });\r\n        tag.append(btn, span);\r\n        btn.addEventListener('click', e => {\r\n            this.deleteBrand(val);\r\n        });\r\n        return tag;\r\n    }\r\n    _showBtnUp() {\r\n        this.btnUp.style.display = 'block';\r\n        this.btnUp.classList.remove('hiding');\r\n        this.btnUp.classList.add('showing');\r\n        this.btnUpIsShown = true;\r\n        clearTimeout(this.btnShowTimeout);\r\n        this.btnShowTimeout = setTimeout(() => {\r\n            this.btnUp.classList.remove('showing');\r\n        }, 250);\r\n    }\r\n    _hideBtnUp() {\r\n        this.btnUp.classList.remove('showing');\r\n        this.btnUp.classList.add('hiding');\r\n        this.btnUpIsShown = false;\r\n        clearTimeout(this.btnShowTimeout);\r\n        this.btnShowTimeout = setTimeout(() => {\r\n            this.btnUp.style.display = '';\r\n            this.btnUp.classList.remove('hiding');\r\n        }, 250);\r\n    }\r\n    _setupBtnUp() {\r\n        if (this.btnUp) {\r\n            /* клик по кнопке \"к фильтру\" */\r\n            const anchor = this.btnUp.querySelector('a[href=\"#filter\"]');\r\n            const path = anchor.getAttribute('href');\r\n            anchor.addEventListener('click', e => {\r\n                e.preventDefault();\r\n                document.querySelector(path).scrollIntoView({block: \"start\", behavior: \"smooth\"});\r\n            });\r\n            /* плавное появление и скрытие кнопки \"к фильтру\" при скролле */\r\n            const filterRect = this.el.getBoundingClientRect();\r\n            const activePos = filterRect.bottom + pageYOffset;\r\n            window.addEventListener('scroll', e => {\r\n                if (pageYOffset >= activePos && !this.btnUpIsShown) {\r\n                    this._showBtnUp();\r\n                } else if (pageYOffset < activePos && this.btnUpIsShown) {\r\n                    this._hideBtnUp();\r\n                }\r\n            });\r\n        }\r\n    }\r\n    getData(set) {\r\n        return Array.from(set);\r\n    }\r\n    getAllData() {\r\n        const obj = {};\r\n        this.catsNames.forEach(cat => {obj[cat] = this.getData(this[cat]);});\r\n        return obj;\r\n    }\r\n    setup() {\r\n        this._setupTitles();\r\n        this._setupListTitles();\r\n        this._setupRangeFields('price');\r\n        this._setupRangeFields('width');\r\n        this._setupRangeFields('depth');\r\n        // this._setupPriceInputs();\r\n        this._setupBrands();\r\n        this._setupOtherCats();\r\n\r\n\r\n        this._validateDecimal(this.el.querySelectorAll('input[name^=price]'));\r\n        this._validateDecimal(this.el.querySelectorAll('input[name^=width]'));\r\n        this._validateDecimal(this.el.querySelectorAll('input[name^=depth]'));\r\n        this._setupBtnsReset();\r\n        this._setupBtnUp();\r\n\r\n        // this.checkBoxes.forEach(el => {\r\n        //     el.addEventListener('change', e => {\r\n        //         this.touch();\r\n        //     });\r\n        // });\r\n        \r\n\r\n    }\r\n}\r\n\r\nclass Tooltips {\r\n    constructor({offsetX, offsetY}) {\r\n        this.elems = document.querySelectorAll('[data-tooltip]');\r\n        this.offsetX = offsetX || 5;\r\n        this.offsetY = offsetY || 15;\r\n        if (this.elems.length > 0) {\r\n            this.setup();\r\n        }\r\n    }\r\n    getTooltip(parent) {\r\n        const text = parent.getAttribute('data-tooltip');\r\n        const side = parent.getAttribute('data-side');\r\n        const tooltip = getNewNode({\r\n            text: text,\r\n            classList: 'tooltip',\r\n        });\r\n        if (side) {tooltip.classList.add('tooltip--' + side)}\r\n        return tooltip;\r\n    }\r\n    getTooltipPosition(parent) {\r\n        const rect = parent.getBoundingClientRect();\r\n        const x = Math.round(rect.left);\r\n        const y = Math.round(rect.top + window.scrollY + rect.height + this.offsetY);\r\n        return {x, y};\r\n    }\r\n    setup() {\r\n        this.elems.forEach(el => {\r\n            let tooltip = this.getTooltip(el);\r\n            el.addEventListener('mouseenter', e => {\r\n                const {x, y} = {...this.getTooltipPosition(el)};\r\n                tooltip.style.left = x + 'px';\r\n                tooltip.style.top = y + 'px';\r\n                document.body.appendChild(tooltip);\r\n            });\r\n            el.addEventListener('mouseleave', e => {\r\n                document.body.removeChild(tooltip);\r\n            });\r\n        });\r\n    }\r\n}\r\n\r\nclass Modal {\r\n    constructor(selector, {onFirstOpen, callSelector, withForm = false}) {\r\n        this.selector = selector;\r\n        this.el = document.querySelector(this.selector);\r\n        if (this.el) {\r\n            this.onFirstOpen = onFirstOpen || function(){};\r\n            this.callSelector = callSelector || '.call-modal';\r\n            this.triggers = document.querySelectorAll(this.callSelector + '[data-target=\"' + this.el.getAttribute('id') + '\"]');\r\n            this.closeBtn = this.el.querySelector('.modal__close');\r\n            this.overlay = this.el.querySelector('.modal__overlay');\r\n            this.opened = false;\r\n            this.form = withForm ? this.el.querySelector('form') : null;\r\n            this.setup();\r\n            // console.log(this.form);\r\n        }\r\n    }\r\n    showModal(disableAnimation = false) {\r\n        if (disableAnimation) {\r\n            this.el.classList.add('active');\r\n        } else {\r\n            this.el.classList.remove('hiding');\r\n            this.el.classList.add('active');\r\n            this.el.classList.add('showing');\r\n            setTimeout(() => {\r\n                this.el.classList.remove('showing');\r\n            }, 250);\r\n        }\r\n        document.querySelector('.wrapper').classList.add('blured');\r\n    }\r\n    hideModal(disableAnimation = false) {\r\n        if (disableAnimation) {\r\n            this.el.classList.remove('active');\r\n        } else {\r\n            this.el.classList.remove('showing');\r\n            this.el.classList.add('hiding');\r\n            setTimeout(() => {\r\n                this.el.classList.remove('active');\r\n                this.el.classList.remove('hiding');\r\n            }, 250);\r\n        }\r\n        document.querySelector('.wrapper').classList.remove('blured');\r\n    }\r\n    showingHandler() {\r\n        this.el.classList.contains('active') ?\r\n            this.hideModal() :\r\n            this.showModal();\r\n    }\r\n    setup() {\r\n        this.closeBtn.addEventListener('click', (e) => {\r\n            this.hideModal();\r\n        });\r\n        this.overlay.addEventListener('mousedown', (e) => {\r\n            if (e.target === this.overlay) {\r\n                this.hideModal();\r\n            }\r\n        })\r\n        this.triggers.forEach((el) => {\r\n            el.addEventListener('click', (e) => {\r\n                e.preventDefault();\r\n                this.showingHandler();\r\n                if (!this.opened) {\r\n                    this.onFirstOpen();\r\n                    this.opened = true;\r\n                }\r\n            });\r\n        });\r\n    }\r\n}\r\n\r\nconst modalCallMe = new Modal('#callMe', {\r\n    callSelector: '.call-modal',\r\n    withForm: true\r\n});\r\nconst modalSignIn = new Modal('#signIn', {\r\n    callSelector: '.call-modal',\r\n    withForm: true\r\n});\r\n\r\nconst catalogFilter = new Filter('#filter', {\r\n    classnames: {\r\n        cats: '.filter__cat',\r\n        titles: '.filter__cat-title',\r\n    }\r\n});\r\n\r\nsetLabelUp();\r\n\r\nconst pagePath = window.location.pathname;\r\nmarkActivePage();\r\nif (pagePath === '' || pagePath === '/') {\r\n    document.body.classList.add('index-page')\r\n} else {\r\n    for (let key in pageNames) {\r\n        const res = pagePath.match(pageNames[key]);\r\n        if (res) {document.body.classList.add(res[0] + '-page')}\r\n    }\r\n}\r\n\r\nconst headerSearchField = new SearchField({\r\n    formSelector: '.header .actions__search'\r\n});\r\n\r\nconst productsTabs = new Tabs({\r\n    tabsSelector: '.products__category-tabs',\r\n    tabSelector: '.products__category-tab',\r\n});\r\nconst productsGridTabs = new Tabs({\r\n    tabsSelector: '.products__type-tabs',\r\n    tabSelector: '.products__type-tab',\r\n});\r\n\r\nconst productCardInfoTabs = new Tabs({\r\n    tabsSelector: '.product__info-tabs',\r\n    withContent: true,\r\n    // contentBoxSelector: '.product__info-content-box'\r\n});\r\nconst deliveryTabs = new Tabs({\r\n    tabsSelector: '.delivery__info-tabs',\r\n    withContent: true,\r\n    // contentBoxSelector: '.product__info-content-box'\r\n});\r\n\r\nconst headerCatalog = new MenuCatalog({\r\n    menuSelector: '.header__menu'\r\n});\r\n\r\nconst productCards = new ProductCards({\r\n    cardSelector: '.product-card'\r\n});\r\n\r\nconst tooltips = new Tooltips({});\r\n\r\n\r\n\r\n\r\nif (nodeExist('.brands__slider.splide')) {\r\n    const brandsSlider = new Splide('.brands__slider.splide', {\r\n        type: 'loop',\r\n        perPage: 4,\r\n        perMove: 1,\r\n        pagination: false\r\n    }).mount();\r\n}\r\n\r\nif (nodeExist('.banner-slider.splide')) {\r\n    const bannerSlider = new Splide('.banner-slider.splide', {\r\n        type: 'loop',\r\n        perPage: 1,\r\n        perMove: 1,\r\n        pagination: false,\r\n        arrows: false,\r\n        gap: 40,\r\n        autoplay: true,\r\n        interval: 3000,\r\n        drag: false,\r\n        pauseOnHover: false,\r\n        pauseOnFocus: false,\r\n    }).mount();\r\n}\r\n\r\n\r\n\r\nif (nodeExist('.product__view-slider.splide')) {\r\n    const productCardThumbs = new Splide( '.product__view-slider.splide', {\r\n        type: 'loop',\r\n        perPage: 3,\r\n        perMove: 1,\r\n        height: 380,\r\n        gap         : 8,\r\n        cover       : false,\r\n        isNavigation: true,\r\n        pagination: false,\r\n        focus       : 'center',\r\n        direction: 'ttb',\r\n    }).mount();\r\n    const productCardPrimary = new Splide( '.product__view-img-wrapper', {\r\n        type       : 'fade',\r\n        pagination : false,\r\n        arrows     : false,\r\n        cover      : false,\r\n        drag: false,\r\n    });\r\n    productCardPrimary.sync( productCardThumbs ).mount();\r\n}\r\n"],"file":"../main.min.js"}